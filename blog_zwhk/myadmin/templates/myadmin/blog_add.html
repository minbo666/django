{% load staticfiles %}
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        {% include "myadmin/inc/header.html" %}
        <link rel="stylesheet" type="text/css" href="{% static 'simditor/styles/simditor.css' %}" />
        <script type="text/javascript" src="{% static 'simditor/scripts/module.js' %}"></script>
        <script type="text/javascript" src="{% static 'simditor/scripts/hotkeys.js' %}"></script>
        <script type="text/javascript" src="{% static 'simditor/scripts/uploader.js' %}"></script>
        <script type="text/javascript" src="{% static 'simditor/scripts/simditor.js' %}"></script>
    </head>
    <body>
        {% include "myadmin/inc/nav.html" %}
        <div class="container">
            <div class="page-header">
                <h2>文章管理
                    <small class="pull-right">
                        <a href="{% url 'blog_list' %}" class="btn btn-primary" href=""><span class="glyphicon glyphicon-chevron-left"></span> 返回</a>
                    </small>
                </h2>
            </div>

        <div class="col-md-12">
            <p class='text-danger'></p>
            <form class="form-horizontal" action="{% url 'blog_operate' operate %}" method="post">
            {% csrf_token %}
                <input type="text" name="id" value="{{ blog.id }}" hidden/>
                <div class="form-group">
                    <label for="title" class="col-sm-2 control-label">标题</label>
                    <div class="col-sm-4">
                        <input type="text" name="title" class="form-control" id="title" placeholder="请输入标题" value="{{ blog.title }}" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="author" class="col-sm-2 control-label">作者</label>
                    <div class="col-sm-4">
                        <input type="text" name="author" class="form-control" id="author" placeholder="请输入作者" value="{% if operate = 'update' %}{{ blog.author }}{% else %}{{ user.nickname }}{% endif %}" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="category" class="col-sm-2 control-label">分类</label>
                    <div class="col-sm-4">
                        <input type="text" name="category" class="form-control" id="category" placeholder="请输入类型" value="{{ blog.category }}" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="content" class="col-sm-2 control-label">正文</label>
                    <div class="col-sm-10">
                        <textarea name="content" class="form-control" id="content" rows="10" required>{{ blog.content|safe }}</textarea>
                        <script>
                            var editor = new Simditor({
                                textarea: $('#content'),
                                upload: {
                                    url:'/admin/upload/',
                                    fileKey:'upload'
                                },
                                placeholder: '请输入正文...',
                                toolbar: [
                                    'title',
                                    'bold',
                                    'italic',
                                    'underline',
                                    'strikethrough',
                                    'fontScale',
                                    'color',
                                    'ol'    ,
                                    'ul'  ,
                                    'blockquote',
                                    'code'    ,
                                    'table',
                                    'link',
                                    'image',
                                    'hr'   ,
                                    'indent',
                                    'outdent',
                                    'alignment'
                                ],
                                allowedAttributes:{
                                    img: ['src', 'alt', 'class','width','height']
                                }
                            });
                        </script>
                    </div>
                </div>


                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button type="submit" class="btn btn-default">提交</button>
                    </div>
                </div>
            </form>
        </div>


        </div>
    </body>
</html>
