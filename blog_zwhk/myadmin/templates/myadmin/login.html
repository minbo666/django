{% load staticfiles %}
<!DOCTYPE html>
<html >
<head>
    <meta charset="UTF-8">
    <title>博客后台登录</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/login.css' %}">
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/jquery.cookie.js' %}"></script>
    <style type="text/css">
        body{
            text-align: center;
            overflow: hidden;
            background:#00A684;
        }
     </style>
</head>
<body>
  <canvas id="Mycanvas"></canvas>
  <div class="login">
  <span style="display: none;position: relative;margin-bottom: 100px;" id="error_show"></span>
   <h1 style="font-size: 22px;margin-bottom: 20px;color:#3cb399;text-shadow:5px 5px 5px #201a1a">系统登录</h1>
    <form method="post" id="login_form" role="form">
        {% csrf_token %}
      	<input type="text" id="username" name="username" placeholder="Username" required="required" />
        <input type="password" id="password" name="password" placeholder="Password" required="required" />
        <button type="submit" style="color: #70C5B5" class="btn btn-primary btn-block btn-large">submit</button>
    </form>
</div>

</body>
</html>
<script type="text/javascript" src="{% static 'js/login_bg.js' %}"></script>
<script language="javascript" type="text/javascript">
    $('#login_form').submit(function(){
        $.ajax({
            type:"POST",
            url:"/admin/usercontrol/login",
            data:{"username":$("#username").val(),"password":$("#password").val()},
            beforeSend:function(xhr){
                xhr.setRequestHeader("X-CSRFToken", $.cookie('csrftoken'));
            },
            success:function(data,textStatus){
                var errors = data["errors"];
                if(errors.length==0){
                    location.replace("blog/");
                }
                else{
                    var str = ""
                    for (var key in errors){
                        str += errors[key]+"\n";
                    }
                    $('#error_show').text(str);
                    $('#error_show').show();
                    //alert(str);
                }
            },
            error:function(XMLHttpRequest, textStatus, errorThrown){
                alert(XMLHttpRequest.responseText);
            }
        });
        return false;
    }); 
</script>